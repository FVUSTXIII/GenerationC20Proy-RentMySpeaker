<!DOCTYPE html>
<html>
	<head>
			<title>Rent my Speaker</title>
			<meta charset="utf-8">
			<link rel="stylesheet" href="css/loginpr.css">
	</head>
	<body>
		<iframe id="dumpframe" style="display: none;"></iframe>
			<div class="lo">
				<h2>Login</h2>
				<form>
					<label for="correo">Correo</label>
					<input type="text" name="correo" placeholder="&#128231;">
					<label for="password">Contraseña</label>
					<input type="password" name="password" placeholder="&#128273;">
					<button type ="button" id="a">Enviar</button>
				</form>
			</div>
		
		<script type="text/javascript">
			window.onload= console.log("hola?");
			var a = document.getElementById("a"); 
			a.onclick = () => { 
				console.log("hola k tal");
				var correoUsuario = document.getElementsByName("correo")[0].value;
				var url = 'http://localhost:8080/login/user/'+correoUsuario;
				requestM(url, (data) => {
					console.log("aqui de deberia de pasar algo");
					setInlocalStorage("idUsuario", data);
					window.location.replace("index_login.html");
				}, () => {
					console.log("algo salió mal");
				})
			}
			function requestM(url, success, failure) {
				var xhr = new XMLHttpRequest();
				xhr.open('GET', url);
				xhr.onload = () => {
					if (xhr.status === 200) {
						success (xhr.responseText);
					}
					else {
						failure (xhr.responseText);
					}
				}
				xhr.send();
			}
			function setInlocalStorage (key, item) {
				localStorage.setItem(key, item);
			}
		</script>
	</body>
</html>